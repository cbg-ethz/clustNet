library(BBMMclusterEM)

kclust<-3 # number of clusters
n<-16 # number of variables

clustsizes<-2^(1:kclust)*10 # sizes of the clusters

binaryclusterdata<-createBinaryData(clustsizes,n,seed=1) # generate some artifical data
# the first argument are the sizes of the clusters, the second the number of variables

chi <- 1 # pseudocounts for the Beta prior
startseed<-100
nIterations<-10

# run the clustering over a range of initial points

clustering<- BBMMclusterEM(binaryMatrix = binaryclusterdata, chi = chi, kclust = kclust, startseed = startseed, nIterations = nIterations, verbose=TRUE)

minAIC <- clustering$testAIC
bestseed <- clustering$seed
newclustermembership <- clustering$newclustermembership
relativeweights <- clustering$relativeweights

#save(minAIC,bestseed,newclustermembership,relativeweights,
#     file=paste("./BMMclusterEMk",kclust,"chi",chi,"seeds",startseed,"its",nIterations,".RData",sep=""))

# search over a range of pseudocounts and number of clusters for the best AIC

chiVec <- c(0:16)/4 # range of values to test
minK <- 2
maxK <- 5

AICsearch<-bestAICsearch(binaryMatrix = binaryclusterdata, minK = minK, maxK = maxK, chiVec = chiVec, startseed = 100, nIterations = 10, AICrange = 25)

#for(ii in 1:length(chiVec)){ # compare the results with 3 clusters to the true cluster assignments
#  print(table(AICsearch[[ii*(maxK-minK+1)-2]]$newclustermembership,rep(1:3,clustsizes)))
#}


